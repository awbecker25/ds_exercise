
```{r}
library(tidyverse)
library(caret)
library(ranger)
```

```{r}
gene_df <- read_csv("data/gene data.csv")
```

```{r}
str(gene_df)
```

```{r}
gene_df$Class <- as.factor(gene_df$Class)
```

```{r}
summary(gene_df)
```

```{r}
sum(is.na(gene_df))
```


```{r}
gene_df$Class <- as.factor(gene_df$Class)

set.seed(42)
in_training <- createDataPartition(gene_df$Class, p = 0.2, list = FALSE)
train <- gene_df[in_training,]
test <- gene_df[-in_training,]
```

```{r}
model1 <- glm(Class ~ ., data = train, family = "binomial")
```

```{r}
pred_prob <- predict(model1, test, type = "response")
pred_class <- as.factor(ifelse(pred_prob > 0.5, 1, 0))
```

```{r}
model1_eval <- confusionMatrix(pred_class, test$Class)
model1_eval
```

```{r}
set.seed(42)
model2 <- train(Class ~ .,
                data = train,
                method = "rf")
```